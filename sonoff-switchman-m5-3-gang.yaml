substitutions:
  name: sonoff-m5-3-gang
  friendly_name: Sonoff SwitchMan M5 3-gang

esphome:
  name: $name
  name_add_mac_suffix: true
  project:
    name: esphome.sonoff-switchman-m5-3-gang
    version: "1.0"

esp32:
  board: esp32dev
  framework:
    type: arduino

logger:

api:

ota:

wifi:
  ap: {}

dashboard_import:
  package_import_url: github://jesserockz/sonoff-configs/sonoff-switchman-m5-3-gang.yaml@main

improv_serial:

button:
  - platform: restart
    id: restart_button
    name: ${friendly_name} Restart

sensor:
  - platform: uptime
    name: ${friendly_name} Uptime
    disabled_by_default: true

binary_sensor:
  - platform: status
    name: ${friendly_name} Status

  - platform: gpio
    name: ${friendly_name} 1
    disabled_by_default: true
    pin:
      number: 4
      inverted: true
    on_click:
      - switch.toggle: relay_1

  - platform: gpio
    name: ${friendly_name} 2
    disabled_by_default: true
    pin:
      number: 0
      inverted: true
    on_multi_click:
      - timing:
          - ON for 50ms to 350ms
          - OFF for at least 50ms
        then:
          - switch.toggle: relay_2
      - timing:
          - ON for at least 5s
        then:
          - button.press: restart_button

  - platform: gpio
    name: ${friendly_name} 3
    disabled_by_default: true
    pin:
      number: 15
      inverted: true
    on_click:
      - switch.toggle: relay_3

switch:
  - platform: gpio
    name: Relay 1
    id: relay_1
    pin:
      number: 23

  - platform: gpio
    name: Relay 2
    id: relay_2
    pin:
      number: 19

  - platform: gpio
    name: Relay 3
    id: relay_3
    pin:
      number: 22

light:
  - platform: status_led
    pin:
      number: 5
      inverted: true
    id: status_light
